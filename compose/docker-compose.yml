services:
  caddy:
    build:
      context: ../.
      dockerfile: Dockerfile
      args:
        - CADDY_VERSION=2.10.0
        - LINODE_PLUGIN_FORK=github.com/HugoKlepsch/caddy-dns_linode@v0.1.0
    restart: unless-stopped
    network_mode: host
    volumes:
      - ${HOME_PORTAL_DIR}/Caddyfile:/etc/caddy/Caddyfile:ro
      - ${HOME_PORTAL_DIR}/config:/config
      - ${HOME_PORTAL_DIR}/data:/data
    environment:
      - LINODE_DNS_PAT=${LINODE_DNS_PAT}
      - LINODE_API_URL=${LINODE_API_URL}
      - LINODE_API_VERSION=${LINODE_API_VERSION}
